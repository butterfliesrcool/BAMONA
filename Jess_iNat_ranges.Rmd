---
title: "Jess_iNat_ranges"
author: "Jessica Herrmann"
date: "2022-11-10"
output: html_document
---
Load package libraries
```{r}
library(curl)
library(ggplot2)
library(MASS)
library(curl)
library(raster)
library(spatialEco)
library(lubridate)
library(rstudioapi)
library(ggmap)
```

Linking in API key
```{r}
register_google(key = "")
```

Loading/cleaning the data for each species
```{r}
### battus 
b <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_battus_philenor_for_r.csv")
battus <- read.csv(b, header = TRUE, sep = ",")
head(battus)

length(battus$id) ### Sample size: 34,893
b <- subset(battus, select = c(id, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name) )
head(b)
battus <- na.omit(b)
length(battus$id) ### New sample size: 34,795
```

```{r}
##   limenitis 
l <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_limenitis_arthemis_astyanax.csv")
limenitis <- read.csv(l, header = TRUE, sep = ",")
head(limenitis)

length(limenitis$id) ### Sample Size: 20,908
l <- subset(limenitis, select = c(id, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name) )
head(l)
limenitis <- na.omit(l)
length(limenitis$id) ###New Sample Size:20,855
```

```{r}
##   polyxenes
p <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_papilio_polyxenes.csv")
polyxenes <- read.csv(p, header = TRUE, sep = ",")
head(polyxenes)

length(polyxenes$id) ### Sample Size: 58,735
p <- subset(polyxenes, select = c(id, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name) )
head(p)
polyxenes <- na.omit(p)
length(polyxenes$id) ###New Sample Size: 58,563
```

```{r}
##   troilus
t <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_papilio_troilus.csv")
troilus <- read.csv(t, header = TRUE, sep = ",")
head(troilus)

length(troilus$id) ### Sample Size: 25,174
t <- subset(troilus, select = c(id, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name) )
head(t)
troilus <- na.omit(t)
length(troilus$id) ###New Sample Size: 25,077
```

```{r}
##   glaucus
g <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_papilio_glaucus%20(version%201).xlsb.csv")
glaucus <- read.csv(g, header = TRUE, sep = ",")
head(glaucus)

length(glaucus$id) ### Sample Size: 66,657
g <- subset(glaucus, select = c(id, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name, morph) )
head(g)
glaucus <- na.omit(g)
length(glaucus$id) ###New Sample Size: 64,713

###### Separate only mimetic morphs 
glaucus <- subset(glaucus, morph == "black", drop = FALSE)
length(glaucus$id) ###Final Sample Size: 15,988
```

```{r}
##   diana 
d <- curl("https://raw.githubusercontent.com/butterfliesrcool/BAMONA/main/iNaturalist_speyeria_diana_edited%20-%20Sheet1.csv")
diana <- read.csv(d, header = TRUE, sep = ",")
head(diana)

length(diana$id) ### Sample Size: 657
d <- subset(diana, select = c(id, sex, observed_on, latitude, longitude, place_county_name, place_state_name, scientific_name) )
head(d)

diana <- na.omit(d)
length(diana$id) ### New Sample Size: 651

###### Separate only mimetic morphs 
diana <- subset(diana, sex == "f", drop = FALSE)
length(diana$id) ### Final Sample Size: 186
```

Use the lubridate() package to separate data by years
```{r} 
## battus
bat.dates <- parse_date_time(battus$observed_on, "ymd")
bat.years <- year(bat.dates) # year() fxn creates separate column for years
battus$years <- bat.years # adds "years" column back into data set

# orders data set by "years" decreasing (most recent first)
battus <- battus[order(battus$years,decreasing=T),]
battus

# shows first and last six data points
head(battus)
tail(battus) #earliest year for Battus in iNat was 1973 (Texas)

# increases the max.print so we can see all data (otherwise R cuts it off at the first 1000 data points).
#options(max.print=1000000)
#battus$years
```

```{r} 
## limenitis
lim.dates <- parse_date_time(limenitis$observed_on, "ymd")
lim.years <- year(lim.dates)
limenitis$years <- lim.years

limenitis <- limenitis[order(limenitis$years,decreasing=T),]
limenitis

head(limenitis)
tail(limenitis) #earliest year is 1972 (Texas)
```
```{r} 
## polyxenes
pol.dates <- parse_date_time(polyxenes$observed_on, "ymd")
pol.years <- year(pol.dates)
polyxenes$years <- pol.years

polyxenes <- polyxenes[order(polyxenes$years,decreasing=T),]
polyxenes

head(polyxenes)
tail(polyxenes) #earliest year is 1953 (Arizona)
```
```{r} 
## troilus
tro.dates <- parse_date_time(troilus$observed_on, "ymd")
tro.years <- year(tro.dates)
troilus$years <- tro.years

troilus <- troilus[order(troilus$years,decreasing=T),]
troilus

head(troilus)
tail(troilus) #earliest year is 1978 (Florida)
```

```{r} 
## glaucus
gla.dates <- parse_date_time(glaucus$observed_on, "mdy") # note - the date formatting for P. glaucus was "mdy" instead of "ymd"
gla.years <- year(gla.dates)
glaucus$years <- gla.years

glaucus <- glaucus[order(glaucus$years,decreasing=T),]
glaucus

head(glaucus)
tail(glaucus) #earliest record = 1973 in TX
```

```{r} 
## diana
dia.dates <- parse_date_time(diana$observed_on, "ymd")
dia.years <- year(dia.dates)
diana$years <- dia.years

diana <- diana[order(diana$years,decreasing=T),]
diana

head(diana)
tail(diana) #earliest year is 2001 (Georgia)
```

Since there is so much iNat data, I am going to create histograms to group data points by year and see which years/time ranges have the most data points.
```{r}
## Battus
peaks.by.year <- aggregate(x=battus$scientific_name, by= list(battus$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

b <- ggplot(abundance, aes(x=years, y=sightings)) 
b <- b + geom_bar(stat="identity", color="black",fill="grey")

b
```

```{r}
## Limenitis
peaks.by.year <- aggregate(x=limenitis$scientific_name, by= list(limenitis$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

l <- ggplot(abundance, aes(x=years, y=sightings)) 
l <- l + geom_bar(stat="identity", color="black",fill="grey")

l
```
```{r}
## polyxenes
peaks.by.year <- aggregate(x=polyxenes$scientific_name, by= list(polyxenes$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

p <- ggplot(abundance, aes(x=years, y=sightings)) 
p <- p + geom_bar(stat="identity", color="black",fill="grey")

p
```
```{r}
## troilus
peaks.by.year <- aggregate(x=troilus$scientific_name, by= list(troilus$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

t <- ggplot(abundance, aes(x=years, y=sightings)) 
t <- t + geom_bar(stat="identity", color="black",fill="grey")

t
```
```{r}
## glaucus
peaks.by.year <- aggregate(x=glaucus$scientific_name, by= list(glaucus$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

g <- ggplot(abundance, aes(x=years, y=sightings)) 
g <- g + geom_bar(stat="identity", color="black",fill="grey")

g
```
```{r}
## diana
peaks.by.year <- aggregate(x=diana$scientific_name, by= list(diana$years), FUN=length)
peaks.by.year

years <- peaks.by.year$Group.1
length(years)
sightings <- peaks.by.year$x
length(sightings)
abundance <- data.frame(years, sightings)
abundance

d <- ggplot(abundance, aes(x=years, y=sightings)) 
d <- d + geom_bar(stat="identity", color="black",fill="grey")

d
```
Here I am going to divide my data by year, from 2012 - 2022, for each species.
```{r}
## Battus

battus.2012 <- subset(battus, years %in% c("2012"), drop = FALSE)
battus.2012
# n = 180

battus.2013 <- subset(battus, years %in% c("2013"), drop = FALSE)
battus.2013
# n = 244

battus.2014<- subset(battus, years %in% c("2014"), drop = FALSE)
battus.2014
# n = 357

battus.2015 <- subset(battus, years %in% c("2015"), drop = FALSE)
battus.2015
# n = 622

battus.2016 <- subset(battus, years %in% c("2016"), drop = FALSE)
battus.2016
# n = 1181

battus.2017 <- subset(battus, years %in% c("2017"), drop = FALSE)
battus.2017
# n = 2290

battus.2018 <- subset(battus, years %in% c("2018"), drop = FALSE)
battus.2018
# n = 3779

battus.2019 <- subset(battus, years %in% c("2019"), drop = FALSE)
battus.2019
# n = 5479

battus.2020 <- subset(battus, years %in% c("2020"), drop = FALSE)
battus.2020
# n = 6093

battus.2021 <- subset(battus, years %in% c("2021"), drop = FALSE)
battus.2021
# n = 7747
```

```{r}
## Limenitis

limenitis.2012 <- subset(limenitis, years %in% c("2012"), drop = FALSE)
limenitis.2012
# n = 88

limenitis.2013 <- subset(limenitis, years %in% c("2013"), drop = FALSE)
limenitis.2013
# n = 124

limenitis.2014<- subset(limenitis, years %in% c("2014"), drop = FALSE)
limenitis.2014
# n = 159

limenitis.2015 <- subset(limenitis, years %in% c("2015"), drop = FALSE)
limenitis.2015
# n = 373

limenitis.2016 <- subset(limenitis, years %in% c("2016"), drop = FALSE)
limenitis.2016
# n = 553

limenitis.2017 <- subset(limenitis, years %in% c("2017"), drop = FALSE)
limenitis.2017
# n = 1006

limenitis.2018 <- subset(limenitis, years %in% c("2018"), drop = FALSE)
limenitis.2018
# n = 1836

limenitis.2019 <- subset(limenitis, years %in% c("2019"), drop = FALSE)
limenitis.2019
# n = 3796

limenitis.2020 <- subset(limenitis, years %in% c("2020"), drop = FALSE)
limenitis.2020
# n = 4482

limenitis.2021 <- subset(limenitis, years %in% c("2021"), drop = FALSE)
limenitis.2021
# n = 4723
```
```{r}
## polyxenes

polyxenes.2012 <- subset(polyxenes, years %in% c("2012"), drop = FALSE)
polyxenes.2012
# n = 252

polyxenes.2013 <- subset(polyxenes, years %in% c("2013"), drop = FALSE)
polyxenes.2013
# n = 336

polyxenes.2014<- subset(polyxenes, years %in% c("2014"), drop = FALSE)
polyxenes.2014
# n = 457

polyxenes.2015 <- subset(polyxenes, years %in% c("2015"), drop = FALSE)
polyxenes.2015
# n = 632

polyxenes.2016 <- subset(polyxenes, years %in% c("2016"), drop = FALSE)
polyxenes.2016
# n = 1281

polyxenes.2017 <- subset(polyxenes, years %in% c("2017"), drop = FALSE)
polyxenes.2017
# n = 2606

polyxenes.2018 <- subset(polyxenes, years %in% c("2018"), drop = FALSE)
polyxenes.2018
# n = 4923

polyxenes.2019 <- subset(polyxenes, years %in% c("2019"), drop = FALSE)
polyxenes.2019
# n = 10214

polyxenes.2020 <- subset(polyxenes, years %in% c("2020"), drop = FALSE)
polyxenes.2020
# n = 14004

polyxenes.2021 <- subset(polyxenes, years %in% c("2021"), drop = FALSE)
polyxenes.2021
# n = 13003
```
```{r}
## troilus

troilus.2012 <- subset(troilus, years %in% c("2012"), drop = FALSE)
troilus.2012
# n = 109

troilus.2013 <- subset(troilus, years %in% c("2013"), drop = FALSE)
troilus.2013
# n = 171

troilus.2014<- subset(troilus, years %in% c("2014"), drop = FALSE)
troilus.2014
# n = 177

troilus.2015 <- subset(troilus, years %in% c("2015"), drop = FALSE)
troilus.2015
# n = 235

troilus.2016 <- subset(troilus, years %in% c("2016"), drop = FALSE)
troilus.2016
# n = 613

troilus.2017 <- subset(troilus, years %in% c("2017"), drop = FALSE)
troilus.2017
# n = 1275

troilus.2018 <- subset(troilus, years %in% c("2018"), drop = FALSE)
troilus.2018
# n = 1717

troilus.2019 <- subset(troilus, years %in% c("2019"), drop = FALSE)
troilus.2019
# n = 3194

troilus.2020 <- subset(troilus, years %in% c("2020"), drop = FALSE)
troilus.2020
# n = 5553

troilus.2021 <- subset(troilus, years %in% c("2021"), drop = FALSE)
troilus.2021
# n = 5400
```
```{r}
## glaucus

glaucus.2012 <- subset(glaucus, years %in% c("2012"), drop = FALSE)
glaucus.2012
# n = 57

glaucus.2013 <- subset(glaucus, years %in% c("2013"), drop = FALSE)
glaucus.2013
# n = 109

glaucus.2014<- subset(glaucus, years %in% c("2014"), drop = FALSE)
glaucus.2014
# n = 97

glaucus.2015 <- subset(glaucus, years %in% c("2015"), drop = FALSE)
glaucus.2015
# n = 193

glaucus.2016 <- subset(glaucus, years %in% c("2016"), drop = FALSE)
glaucus.2016
# n = 461

glaucus.2017 <- subset(glaucus, years %in% c("2017"), drop = FALSE)
glaucus.2017
# n = 624

glaucus.2018 <- subset(glaucus, years %in% c("2018"), drop = FALSE)
glaucus.2018
# n = 1039

glaucus.2019 <- subset(glaucus, years %in% c("2019"), drop = FALSE)
glaucus.2019
# n = 2875

glaucus.2020 <- subset(glaucus, years %in% c("2020"), drop = FALSE)
glaucus.2020
# n = 3720

glaucus.2021 <- subset(glaucus, years %in% c("2021"), drop = FALSE)
glaucus.2021
# n = 3515
```

```{r}
## diana

diana.2012 <- subset(diana, years %in% c("2012"), drop = FALSE)
diana.2012
# n = 2

diana.2013 <- subset(diana, years %in% c("2013"), drop = FALSE)
diana.2013
# n = 2

diana.2014<- subset(diana, years %in% c("2014"), drop = FALSE)
diana.2014
# n = 2

diana.2015 <- subset(diana, years %in% c("2015"), drop = FALSE)
diana.2015
# n = 7

diana.2016 <- subset(diana, years %in% c("2016"), drop = FALSE)
diana.2016
# n = 3

diana.2017 <- subset(diana, years %in% c("2017"), drop = FALSE)
diana.2017
# n = 16

diana.2018 <- subset(diana, years %in% c("2018"), drop = FALSE)
diana.2018
# n = 13

diana.2019 <- subset(diana, years %in% c("2019"), drop = FALSE)
diana.2019
# n = 17

diana.2020 <- subset(diana, years %in% c("2020"), drop = FALSE)
diana.2020
# n = 23

diana.2021 <- subset(diana, years %in% c("2021"), drop = FALSE)
diana.2021
# n = 50
```

Creating a function to generate ggplot heat maps
```{r}
googleplot_heatmap <- function(data){
  htmap <- ggmap(get_googlemap(center = c(lon = -79.74658480805773, lat = 37.20888926712938),
                                  zoom = 4,scale = 2,
                                  maptype = 'terrain',
                                  color = 'color'))+
  stat_density2d(aes(x = longitude, latitude, fill = ..level..),
                 alpha = .2,
                 bins = 15, data = data, geom = "polygon") +
  labs(fill="Estimated Distribution") +
  scale_fill_viridis_c(option = "plasma")
 
  
  return(htmap)
} 
```

```{r}
## Battus heat maps

battus_2012_heatmap <- googleplot_heatmap(battus.2012)
battus_2013_heatmap <- googleplot_heatmap(battus.2013)
battus_2014_heatmap <- googleplot_heatmap(battus.2014)
battus_2015_heatmap <- googleplot_heatmap(battus.2015)
battus_2016_heatmap <- googleplot_heatmap(battus.2016)
battus_2017_heatmap <- googleplot_heatmap(battus.2017)
battus_2018_heatmap <- googleplot_heatmap(battus.2018)
battus_2019_heatmap <- googleplot_heatmap(battus.2019)
battus_2020_heatmap <- googleplot_heatmap(battus.2020)
battus_2021_heatmap <- googleplot_heatmap(battus.2021)


battus_2012_heatmap
battus_2013_heatmap
battus_2014_heatmap
battus_2015_heatmap
battus_2016_heatmap
battus_2017_heatmap
battus_2018_heatmap
battus_2019_heatmap
battus_2020_heatmap
battus_2021_heatmap
```

```{r}
## Limenitis heat maps

limenitis_2012_heatmap <- googleplot_heatmap(limenitis.2012)
limenitis_2013_heatmap <- googleplot_heatmap(limenitis.2013)
limenitis_2014_heatmap <- googleplot_heatmap(limenitis.2014)
limenitis_2015_heatmap <- googleplot_heatmap(limenitis.2015)
limenitis_2016_heatmap <- googleplot_heatmap(limenitis.2016)
limenitis_2017_heatmap <- googleplot_heatmap(limenitis.2017)
limenitis_2018_heatmap <- googleplot_heatmap(limenitis.2018)
limenitis_2019_heatmap <- googleplot_heatmap(limenitis.2019)
limenitis_2020_heatmap <- googleplot_heatmap(limenitis.2020)
limenitis_2021_heatmap <- googleplot_heatmap(limenitis.2021)


limenitis_2012_heatmap
limenitis_2013_heatmap
limenitis_2014_heatmap
limenitis_2015_heatmap
limenitis_2016_heatmap
limenitis_2017_heatmap
limenitis_2018_heatmap
limenitis_2019_heatmap
limenitis_2020_heatmap
limenitis_2021_heatmap
```

```{r}
## polyxenes heat maps

polyxenes_2012_heatmap <- googleplot_heatmap(polyxenes.2012)
polyxenes_2013_heatmap <- googleplot_heatmap(polyxenes.2013)
polyxenes_2014_heatmap <- googleplot_heatmap(polyxenes.2014)
polyxenes_2015_heatmap <- googleplot_heatmap(polyxenes.2015)
polyxenes_2016_heatmap <- googleplot_heatmap(polyxenes.2016)
polyxenes_2017_heatmap <- googleplot_heatmap(polyxenes.2017)
polyxenes_2018_heatmap <- googleplot_heatmap(polyxenes.2018)
polyxenes_2019_heatmap <- googleplot_heatmap(polyxenes.2019)
polyxenes_2020_heatmap <- googleplot_heatmap(polyxenes.2020)
polyxenes_2021_heatmap <- googleplot_heatmap(polyxenes.2021)


polyxenes_2012_heatmap
polyxenes_2013_heatmap
polyxenes_2014_heatmap
polyxenes_2015_heatmap
polyxenes_2016_heatmap
polyxenes_2017_heatmap
polyxenes_2018_heatmap
polyxenes_2019_heatmap
polyxenes_2020_heatmap
polyxenes_2021_heatmap
```
```{r}
## troilus heat maps

troilus_2012_heatmap <- googleplot_heatmap(troilus.2012)
troilus_2013_heatmap <- googleplot_heatmap(troilus.2013)
troilus_2014_heatmap <- googleplot_heatmap(troilus.2014)
troilus_2015_heatmap <- googleplot_heatmap(troilus.2015)
troilus_2016_heatmap <- googleplot_heatmap(troilus.2016)
troilus_2017_heatmap <- googleplot_heatmap(troilus.2017)
troilus_2018_heatmap <- googleplot_heatmap(troilus.2018)
troilus_2019_heatmap <- googleplot_heatmap(troilus.2019)
troilus_2020_heatmap <- googleplot_heatmap(troilus.2020)
troilus_2021_heatmap <- googleplot_heatmap(troilus.2021)


troilus_2012_heatmap
troilus_2013_heatmap
troilus_2014_heatmap
troilus_2015_heatmap
troilus_2016_heatmap
troilus_2017_heatmap
troilus_2018_heatmap
troilus_2019_heatmap
troilus_2020_heatmap
troilus_2021_heatmap
```
```{r}
## glaucus heat maps

glaucus_2012_heatmap <- googleplot_heatmap(glaucus.2012)
glaucus_2013_heatmap <- googleplot_heatmap(glaucus.2013)
glaucus_2014_heatmap <- googleplot_heatmap(glaucus.2014)
glaucus_2015_heatmap <- googleplot_heatmap(glaucus.2015)
glaucus_2016_heatmap <- googleplot_heatmap(glaucus.2016)
glaucus_2017_heatmap <- googleplot_heatmap(glaucus.2017)
glaucus_2018_heatmap <- googleplot_heatmap(glaucus.2018)
glaucus_2019_heatmap <- googleplot_heatmap(glaucus.2019)
glaucus_2020_heatmap <- googleplot_heatmap(glaucus.2020)
glaucus_2021_heatmap <- googleplot_heatmap(glaucus.2021)


glaucus_2012_heatmap
glaucus_2013_heatmap
glaucus_2014_heatmap
glaucus_2015_heatmap
glaucus_2016_heatmap
glaucus_2017_heatmap
glaucus_2018_heatmap
glaucus_2019_heatmap
glaucus_2020_heatmap
glaucus_2021_heatmap
```

```{r}
## diana heat maps

diana_2012_heatmap <- googleplot_heatmap(diana.2012)
diana_2013_heatmap <- googleplot_heatmap(diana.2013)
diana_2014_heatmap <- googleplot_heatmap(diana.2014)
diana_2015_heatmap <- googleplot_heatmap(diana.2015)
diana_2016_heatmap <- googleplot_heatmap(diana.2016)
diana_2017_heatmap <- googleplot_heatmap(diana.2017)
diana_2018_heatmap <- googleplot_heatmap(diana.2018)
diana_2019_heatmap <- googleplot_heatmap(diana.2019)
diana_2020_heatmap <- googleplot_heatmap(diana.2020)
diana_2021_heatmap <- googleplot_heatmap(diana.2021)


diana_2012_heatmap
diana_2013_heatmap
diana_2014_heatmap
diana_2015_heatmap
diana_2016_heatmap
diana_2017_heatmap
diana_2018_heatmap
diana_2019_heatmap
diana_2020_heatmap
diana_2021_heatmap
```

Generate raster heat maps using kde2() function
```{r}
raster_heatmap <- function(data, num_cells, extent){
  interp <- kde2d(data$longitude, data$latitude, n=num_cells, lims=extent)
  rast <- raster(interp)
  rast[rast < 0.001] <- NA # This removes "noisy" low values in our rasters. We will need to determine the lower threshold optimal for our stats analysis, but for now it is set to 0.001. However, lowering this value increases our Pearson correlation coefficient.
  return(rast)
  
} 

conus_extent <- c(-172.54, -47.74, 23.81, 86.46) # coordinate boundaries for continental US, as a vector
x <- 100 # number of raster tiles/pixels per raster. We will need to determine the optimal number of pixels to use here.

```

```{r}
## Battus rasterized heatmaps

battus_2012_heat <- raster_heatmap(battus.2012, n=x, conus_extent)
battus_2013_heat <- raster_heatmap(battus.2013, n=x, conus_extent)
battus_2014_heat <- raster_heatmap(battus.2014, n=x, conus_extent)
battus_2015_heat <- raster_heatmap(battus.2015, n=x, conus_extent)
battus_2016_heat <- raster_heatmap(battus.2016, n=x, conus_extent)
battus_2017_heat <- raster_heatmap(battus.2017, n=x, conus_extent)
battus_2018_heat <- raster_heatmap(battus.2018, n=x, conus_extent)
battus_2019_heat <- raster_heatmap(battus.2019, n=x, conus_extent)
battus_2020_heat <- raster_heatmap(battus.2020, n=x, conus_extent)
battus_2021_heat <- raster_heatmap(battus.2021, n=x, conus_extent)

plot(battus_2012_heat)
plot(battus_2013_heat)
plot(battus_2014_heat)
plot(battus_2015_heat)
plot(battus_2016_heat)
plot(battus_2017_heat)
plot(battus_2018_heat)
plot(battus_2019_heat)
plot(battus_2020_heat)
plot(battus_2021_heat)
```